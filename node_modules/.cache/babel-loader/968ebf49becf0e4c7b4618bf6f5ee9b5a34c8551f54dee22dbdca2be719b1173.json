{"ast":null,"code":"import{useState}from\"react\";import{useAuthContext}from\"../hooks/useAuthContext\";import{useCartContext}from\"../hooks/useCartContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CartItem=_ref=>{let{ci}=_ref;const[error,setError]=useState(null);const{user}=useAuthContext();const[quantity,setQuantity]=useState(ci.quantity);const{dispatch}=useCartContext();const updateCart=async()=>{if(!user){setError(\"You must be logged in\");return;}ci.quantity=Number(quantity);const resp=await fetch('/api/carts',{method:'PATCH',body:JSON.stringify(ci),headers:{\"Content-Type\":'application/json',\"Authorization\":`Bearer ${user.token}`}});const json=await resp.json();if(!resp.ok){setError(json.error);}else if(resp.ok){setError(null);dispatch({type:\"UPDATE_CART\",payload:ci});}};const deleteFromCart=async()=>{if(!user){setError(\"You must be logged in\");return;}dispatch({type:\"REMOVE_FROM_CART\",payload:ci});// const resp = await fetch(`/api/carts/${ci._id}`,{method:\"DELETE\",headers:{\"Authorization\":`Bearer ${user.token}`}});\n// const json = await resp.json();\n// if (resp.ok){\n//     dispatch({type:\"REMOVE_FROM_CART\",payload:json});\n// }\n};return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:ci.prod_name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:quantity,onChange:e=>{setQuantity(e.target.value);}})}),/*#__PURE__*/_jsx(\"td\",{children:Number(ci.price)*Number(quantity)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:updateCart,children:error||\"Update\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:deleteFromCart,children:error||\"Delete\"})})]});};export default CartItem;","map":{"version":3,"names":["useState","useAuthContext","useCartContext","jsx","_jsx","jsxs","_jsxs","CartItem","_ref","ci","error","setError","user","quantity","setQuantity","dispatch","updateCart","Number","resp","fetch","method","body","JSON","stringify","headers","token","json","ok","type","payload","deleteFromCart","children","prod_name","value","onChange","e","target","price","onClick"],"sources":["/home/jeman_06_03/Documents/FrontendCode For Hosting/E-Commerce-Frontend/src/components/CartItem.js"],"sourcesContent":["import { useState } from \"react\"\nimport { useAuthContext } from \"../hooks/useAuthContext\";\nimport { useCartContext } from \"../hooks/useCartContext\";\n\nconst CartItem = ({ci}) => {\n    const [error,setError]         = useState(null);\n    const {user}                   = useAuthContext();\n    const [quantity,setQuantity]   = useState(ci.quantity);\n    const {dispatch}               = useCartContext();\n\n    const updateCart = async () => {\n        if (!user) {\n            setError(\"You must be logged in\");\n            return;\n        }\n        ci.quantity = Number(quantity);\n        const resp = await fetch('/api/carts',{method:'PATCH',body:JSON.stringify(ci),headers:{\"Content-Type\":'application/json',\"Authorization\":`Bearer ${user.token}`}});\n        const json = await resp.json()\n        if (!resp.ok){\n            setError(json.error);\n        }\n        else if (resp.ok){\n            setError(null);\n            dispatch({type:\"UPDATE_CART\",payload:ci});\n        }\n    }\n\n    const deleteFromCart = async () => {\n        if (!user) {\n            setError(\"You must be logged in\");\n            return;\n        }\n        dispatch({type:\"REMOVE_FROM_CART\",payload:ci})\n        // const resp = await fetch(`/api/carts/${ci._id}`,{method:\"DELETE\",headers:{\"Authorization\":`Bearer ${user.token}`}});\n        // const json = await resp.json();\n        // if (resp.ok){\n        //     dispatch({type:\"REMOVE_FROM_CART\",payload:json});\n        // }\n    }\n\n    return (\n        <tr>\n                    {/* The following is book names */}\n                    <td>{ci.prod_name}</td>\n                    {/* The following is books quantity */}\n                    <td><input type='number' value={quantity} onChange={(e)=>{setQuantity(e.target.value)}}/></td>\n                    {/* The following is book prices */}\n                    <td>{Number(ci.price)*Number(quantity)}</td>\n                    {/* The following is just a Update btn */}\n                    <td><button onClick={updateCart}>{error || \"Update\"}</button></td>\n                    {/* The following is just a DELET btn */}\n                    <td><button onClick={deleteFromCart}>{error || \"Delete\"}</button></td>\n        </tr>\n    )\n}\n\nexport default CartItem;"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,OAASC,cAAc,KAAQ,yBAAyB,CACxD,OAASC,cAAc,KAAQ,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEzD,KAAM,CAAAC,QAAQ,CAAGC,IAAA,EAAU,IAAT,CAACC,EAAE,CAAC,CAAAD,IAAA,CAClB,KAAM,CAACE,KAAK,CAACC,QAAQ,CAAC,CAAWX,QAAQ,CAAC,IAAI,CAAC,CAC/C,KAAM,CAACY,IAAI,CAAC,CAAqBX,cAAc,CAAC,CAAC,CACjD,KAAM,CAACY,QAAQ,CAACC,WAAW,CAAC,CAAKd,QAAQ,CAACS,EAAE,CAACI,QAAQ,CAAC,CACtD,KAAM,CAACE,QAAQ,CAAC,CAAiBb,cAAc,CAAC,CAAC,CAEjD,KAAM,CAAAc,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAI,CAACJ,IAAI,CAAE,CACPD,QAAQ,CAAC,uBAAuB,CAAC,CACjC,OACJ,CACAF,EAAE,CAACI,QAAQ,CAAGI,MAAM,CAACJ,QAAQ,CAAC,CAC9B,KAAM,CAAAK,IAAI,CAAG,KAAM,CAAAC,KAAK,CAAC,YAAY,CAAC,CAACC,MAAM,CAAC,OAAO,CAACC,IAAI,CAACC,IAAI,CAACC,SAAS,CAACd,EAAE,CAAC,CAACe,OAAO,CAAC,CAAC,cAAc,CAAC,kBAAkB,CAAC,eAAe,CAAC,UAAUZ,IAAI,CAACa,KAAK,EAAE,CAAC,CAAC,CAAC,CAClK,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAR,IAAI,CAACQ,IAAI,CAAC,CAAC,CAC9B,GAAI,CAACR,IAAI,CAACS,EAAE,CAAC,CACThB,QAAQ,CAACe,IAAI,CAAChB,KAAK,CAAC,CACxB,CAAC,IACI,IAAIQ,IAAI,CAACS,EAAE,CAAC,CACbhB,QAAQ,CAAC,IAAI,CAAC,CACdI,QAAQ,CAAC,CAACa,IAAI,CAAC,aAAa,CAACC,OAAO,CAACpB,EAAE,CAAC,CAAC,CAC7C,CACJ,CAAC,CAED,KAAM,CAAAqB,cAAc,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAI,CAAClB,IAAI,CAAE,CACPD,QAAQ,CAAC,uBAAuB,CAAC,CACjC,OACJ,CACAI,QAAQ,CAAC,CAACa,IAAI,CAAC,kBAAkB,CAACC,OAAO,CAACpB,EAAE,CAAC,CAAC,CAC9C;AACA;AACA;AACA;AACA;AACJ,CAAC,CAED,mBACIH,KAAA,OAAAyB,QAAA,eAEY3B,IAAA,OAAA2B,QAAA,CAAKtB,EAAE,CAACuB,SAAS,CAAK,CAAC,cAEvB5B,IAAA,OAAA2B,QAAA,cAAI3B,IAAA,UAAOwB,IAAI,CAAC,QAAQ,CAACK,KAAK,CAAEpB,QAAS,CAACqB,QAAQ,CAAGC,CAAC,EAAG,CAACrB,WAAW,CAACqB,CAAC,CAACC,MAAM,CAACH,KAAK,CAAC,EAAE,CAAC,CAAC,CAAI,CAAC,cAE9F7B,IAAA,OAAA2B,QAAA,CAAKd,MAAM,CAACR,EAAE,CAAC4B,KAAK,CAAC,CAACpB,MAAM,CAACJ,QAAQ,CAAC,CAAK,CAAC,cAE5CT,IAAA,OAAA2B,QAAA,cAAI3B,IAAA,WAAQkC,OAAO,CAAEtB,UAAW,CAAAe,QAAA,CAAErB,KAAK,EAAI,QAAQ,CAAS,CAAC,CAAI,CAAC,cAElEN,IAAA,OAAA2B,QAAA,cAAI3B,IAAA,WAAQkC,OAAO,CAAER,cAAe,CAAAC,QAAA,CAAErB,KAAK,EAAI,QAAQ,CAAS,CAAC,CAAI,CAAC,EAC9E,CAAC,CAEb,CAAC,CAED,cAAe,CAAAH,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}